##kafka
##简介
 
````
Kafka是一种分布式的，基于发布/订阅的消息系统。
主要特点： 
1.以时间复杂度为O(1)的方式提供消息持久化能力，并保证即使对TB级以上数 据也能保证常数时间的访问性能
2.高吞吐率。即使在非常廉价的商用机器上也能做到单机支持每秒100K条消息 的传输  
3.支持Kafka Server间的消息分区，及分布式消息消费，同时保证每个partition 内的消息顺序传输  
4.同时支持离线数据处理和实时数据处理  
5.高并发：支持数千个客户端同时读写
````
## 组件
* Producers
    * Producers直接发送消息到broker
    * 通过指定Topic，key或partition 机制来判断将这条消息发送到哪个parition
        * paritition机制可以通过指定producer的 paritition.class这一参数来指定，该class必须实现​ kafka.producer.Partitioner​ 接 口 
    * Topic在逻辑上可以被认为是一个在的queue，每条消费都必须指定它的topic。物理上把topic分成一个或多个partition，每个partition在物理上对应一 个文件夹，该文件夹下存储这个partition的所有消息和索引文件。
    * 消息发送分为同步发送和异步发送
        * 发送成功的判断
        ````
        1. acks=0 意味着produce能把消息发送出去，已经发送成功写入Kafka, 一定会丢失一些数据
        2. acks=1 意味着leade在收到消息并把它写到分区数据问津是会返回确认或者错误响应，还是可能会丢数据
        3. acks=all 意味着会等待leader和所有同步follower都收到消息返回成功                
       ````
    *     
````
       broker-0                       produce
            ↖                        ↓topic= topic0 key =n 
            ----------------      -----------------        ------------------
          | topic0-0         |   |  topic0-1        |    |  topic0-2         |
          |topic0-3-follower |   |topic0-0-follower |    |  topic0-1-follower|
         ↙ --------------        ----------------          -----------------
     partion-0                         ↑
                              ----------------
                             |consumer-group-0|  .......   
                              ---------------- 
   =================================paritition=================================
                                         ↓
                                  ------------------  
                                 |   ---     ---     |
                                 |   |   |  |   |    |
                                 |   ---     ---     |
                                 |                   |
                                  -------------------

````
